# FIPS Auditing Cheatsheet

**FIPS Compliance Audit Checklist for Java and Scala Applications**

| Category                     | Checklist Item                                                                                                                                                              | Details & References                                                                                                                                                                                                               |
|------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Module Usage**             | **FIPS-Validated Module Verification**                                                                                                                                    | Ensure that all cryptographic operations are performed by a FIPS 140-validated module. Check the module's certificate number.                                                                                                                      |
|                              | **Provider Configuration**                                                                                                                                                 | Verify that the application is explicitly configured to use the FIPS-validated provider (e.g., Bouncy Castle, WolfSSL). Ensure the correct provider is called at runtime.                                                   |
|                              | **Avoid Mixed Implementations**                                                                                                                                             | Ensure that non-FIPS cryptographic operations (if any) are clearly identified and not used for security-critical functions. Use FIPS mode when performing sensitive operations.                                                                             |
|                              | **Module Version Check**                                                                                                                                                   | Verify the FIPS module version using a query service to confirm the validated module is in use.                                                                                                                                     |
| **Algorithm & Key Management** | **Approved Algorithms Only**                                                                                                                                            | Verify that only FIPS-approved algorithms are used for encryption, decryption, hashing, signing, key agreement, and key transport.  Refer to FIPS 140-3 Annex C or FIPS 140-2 Appendix A and related NIST publications for the approved algorithms and key lengths.|
|                              | **Key Length Compliance**                                                                                                                                                 | Verify that the key lengths meet the minimum requirements as specified by NIST. Minimum 112-bit security strength is required for federal use. Ensure that keys are resistant to exhaustive search. |
|                              | **RSA Key Size**                                                                                                                                                          | Ensure RSA keys used for signatures are at least 2048 bits.  Legacy 1024-bit RSA keys may be allowed for verification, but not generation.                                                                          |
|                              | **Elliptic Curve Compliance**                                                                                                                                            | Confirm that only NIST-approved elliptic curves are used (e.g. P-224, P-256, P-384, P-521).                                                                                                                                  |
|                              | **Hash Function Compliance**                                                                                                                                             | Use SHA-2 (SHA-224 and above) or SHA-3 family of hash functions. SHA-1 can only be used for non-digital signature applications.                                                                                   |
|                              | **HMAC Key Length**                                                                                                                                                        | Ensure HMAC key lengths are at least 112 bits.                                                                                                                                                                            |
|                              | **Key Derivation Function (KDF)**                                                                                                                                         |  Ensure that KDFs used are approved (e.g., PBKDF, KDF from SP 800-135 rev1, or SP 800-56C).                                                                                                          |
|                              | **Key Management Practices**                                                                                                                                                | Verify proper key generation, storage, and destruction as per SP 800-57. Keys should be rolled correctly.   Ensure that private keys are not exported outside the cryptographic module.                                              |
|                              | **Key Storage**                                                                                                                                                          | Check if key storage is done through a FIPS compliant method and not through jks key stores which do not encrypt keys at all. Migrate to BCFKS format if using Bouncy Castle. |
| **Context & Usage**          | **Correct Mode of Operation**                                                                                                                                              | Verify that cryptographic algorithms are used in the correct mode of operation (e.g. GCM, CCM, CMAC, etc).  Ensure that parameters are appropriate for the chosen mode.                                                                |
|                              | **Random Number Generation**                                                                                                                                                | Verify that random number generation is compliant with FIPS 140 requirements, particularly if using them for key generation, initialization vectors (IV), salts, or nonces.  The entropy source should be located inside the cryptographic module’s boundary.                       |
|                              | **TLS/SSL Configuration**                                                                                                                                                   | When using TLS/SSL, ensure that the cipher suites and configurations are compliant with FIPS 140 requirements and supported by the FIPS provider. Check for compliance to specific TLS versions and key exchange algorithms (e.g., no weak ciphers or protocols).    |
|                              | **Digital Signature Verification**                                                                                                                                           | Verify that signature verification is performed using FIPS-compliant algorithms and key sizes. Ensure that the key and signature schemes are paired correctly (e.g., don’t use the same key for both RSASSA-PKCS1-v1.5 and RSASSA-PSS).                                       |
|                              | **Non-Cryptographic Usage of Hash Functions**                                                                                                                             | Verify if non-compliant hashing algorithms (e.g., MD5) are used for non-cryptographic purposes. If used for security related function, then it is a non-compliance.                                                                    |
|                              | **Cryptographic Boundaries**                                                                                                                                              | Make sure that computations are occurring in the FIPS 140-2 module when it is intended to be within the cryptographic boundary.  Ensure the FIPS boundary is not extended accidentally.      |
| **Configuration & Testing**  | **Provider Loading and Configuration**                                                                                                                                    | Verify the correct FIPS provider is loaded in the application and can be queried by the application.                                                                                                                  |
|                              | **Runtime Checks**                                                                                                                                                        | Implement runtime checks to ensure that the FIPS module is operating in FIPS mode during cryptographic operations. Verify that the module is in FIPS mode when a particular call was made.                                        |
|                              | **Self-Tests**                                                                                                                                                           | Verify that the cryptographic module performs self-tests on the algorithms as specified in FIPS 140-3.   All self-tests identified in underlying algorithm standards should be implemented.     |
|                              | **Operational Environment**                                                                                                                                               | For bound modules, ensure the operational environments are the same or one within the other. The EVM should be the same or higher security level as the IUT.        |
|                              | **CI/CD Integration**                                                                                                                                                      | Integrate FIPS compliance checks into the CI/CD pipeline to continuously monitor and maintain compliance with every change to code.                                                                                         |
|                              | **Logging and Error Handling**                                                                                                                                            | Implement logging and error handling mechanisms to detect and prevent compromises resulting from module errors. This should include error logging for self-tests.                                                                         |
